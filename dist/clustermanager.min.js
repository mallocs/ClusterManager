!function e(t,r,o){function s(n,a){if(!r[n]){if(!t[n]){var u="function"==typeof require&&require;if(!a&&u)return u(n,!0);if(i)return i(n,!0);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[n]={exports:{}};t[n][0].call(l.exports,function(e){var r=t[n][1][e];return s(r?r:e)},l,l.exports,e,t,r,o)}return r[n].exports}for(var i="function"==typeof require&&require,n=0;n<o.length;n++)s(o[n]);return s}({1:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){var r=this;t=t||{},this.map=e,this.setMap(e),this.resetManager(t),this.setPrecision(this.zoomToPrecision(this.map.getZoom())),google.maps.event.addDomListener(e,"dragstart",function(){r.mapDragging=!0}),google.maps.event.addDomListener(e,"dragend",function(){r.mapDragging=!1,r._onMapMoveEnd()}),google.maps.event.addDomListener(e,"center_changed",function(){r.mapDragging||r._onMapMoveEnd()}),google.maps.event.addDomListener(e,"zoom_changed",function(){r._onMapMoveEnd()}),"undefined"!=typeof t.markers&&this.addMarkers(t.markers)}var i=e("./utils"),n=e("./LazyMarker"),a=o(n);window.ClusterManager=s||{},s.prototype=new google.maps.OverlayView,s.prototype.onAdd=function(){this.ready_=!0,google.maps.event.trigger(this,"ready_")},s.prototype.draw=function(){},s.prototype.resetManager=function(e){this.markers={},this.clusters={},this.cluster_fns={},this.cluster_meta={};var t=e.precision>=0&&e.precision<=27?e.precision:2;e=i.applyDefaults({padding:200,visualize:!1,zoom_to_precision:function(e){return e+t},cluster_by_distance:!0,cluster_distance_factor:2048e3,icon_color:"00CC00"},e),this.opts=e},s.prototype.setPrecision=function(e){if(!(e>=50||0>e)){if(this.current_precision_=e,this.clear(),"undefined"==typeof this.clusters[e])for(var t=this.getMarkers(),r=0,o=t.length;o>r;r++){var s=t[r];"cluster"!==i.getMarkerMeta(s).subtype&&this.addToCluster(s,i.getMarkerMeta(s).type,e)}this.cluster(),this.updateMarkers()}},s.prototype.getPrecision=function(){return this.current_precision_},s.prototype.getGeohash=function(e,t,r){if(e=Math.min(e,90),e=Math.max(e,-90),t=Math.abs((t+180)%360)-180,0>=r)return"";var o=12,s=parseInt((e+90)*Math.pow(10,o)).toString(2),i=parseInt((t+180)*Math.pow(10,o)).toString(2),n="0000000000000000000000000000000000000000000000000",a=n.substr(0,49-s.length)+s,u=n.substr(0,49-i.length)+i,c=a.substr(0,r)+u.substr(0,r);return c},s.prototype.geohashGetLatLngBounds=function(e){var t=12,r=this.geohashGetPrecision(e),o="0000000000000000000000000000000000000000000000000",s=e.substr(0,r)+o.substr(0,49-r),i=e.substr(r,e.length)+o.substr(0,49-r),n="1111111111111111111111111111111111111111111111111",a=e.substr(0,r)+n.substr(0,49-r),u=e.substr(r,e.length)+n.substr(0,49-r),c=parseInt(s,2),l=parseInt(i,2),h=parseInt(a,2),p=parseInt(u,2),g=Math.max(-90,c/Math.pow(10,t)-90),f=Math.max(-180,l/Math.pow(10,t)-180),d=Math.min(90,h/Math.pow(10,t)-90),m=Math.min(180,p/Math.pow(10,t)-180);return new google.maps.LatLngBounds(new google.maps.LatLng(g,f),new google.maps.LatLng(d,m))},s.prototype.geohashGetPrecision=function(e){var t=e.length/2;return parseInt(t)!==t||0>t||t>=50?void 0:t},s.prototype.getNeighborBoxes=function(e,t){for(var r,o=this.geohashGetLatLngBounds(e),s=this.geohashGetPrecision(e),i=this.getGeohash(o.getSouthWest().lat()+1e-4,o.getSouthWest().lng()-1e-4,s),n=this.getGeohash(o.getSouthWest().lat()-1e-4,o.getSouthWest().lng()+1e-4,s),a=this.getGeohash(o.getNorthEast().lat()+1e-4,o.getNorthEast().lng()-1e-4,s),u=this.getGeohash(o.getNorthEast().lat()-1e-4,o.getNorthEast().lng()+1e-4,s),c=this.getGeohash(o.getSouthWest().lat()+1e-4,o.getSouthWest().lng()+1e-4,s),l=this.getGeohash(o.getSouthWest().lat()-1e-4,o.getSouthWest().lng()-1e-4,s),h=this.getGeohash(o.getNorthEast().lat()+1e-4,o.getNorthEast().lng()+1e-4,s),p=this.getGeohash(o.getNorthEast().lat()-1e-4,o.getNorthEast().lng()-1e-4,s),g=[i,n,a,u,c,l,h,p],f=0,d=[];r=g[f];f++)"undefined"!=typeof this.clusters[s][t][r]&&r!==e&&d.push(r);return d},s.prototype.boxToPolygon=function(e,t){t=i.applyDefaults({map:this.map,strokeColor:"#f33f00",strokeWeight:5,strokeOpacity:1,fillColor:"#ff0000",fillOpacity:.2},t);var r=this.geohashGetLatLngBounds(e),o=r.getNorthEast(),s=r.getSouthWest(),n=new google.maps.Polygon({paths:t.paths||[o,new google.maps.LatLng(o.lat(),s.lng()),s,new google.maps.LatLng(s.lat(),o.lng()),o],strokeColor:t.strokeColor,strokeWeight:t.strokeWeight,strokeOpacity:t.strokeOpacity,fillColor:t.fillColor,fillOpacity:t.fillOpacity,map:t.map});return n},s.prototype.boxInBounds=function(e,t,r){var o=new google.maps.LatLngBounds(this.map.getBounds().getSouthWest(),this.map.getBounds().getNorthEast());if("undefined"!=typeof r){var s=this.map.getProjection(),i=Math.pow(2,this.map.getZoom()),n=new google.maps.Point(r/i||0,r/i||0),a=s.fromLatLngToPoint(t.getNorthEast()),u=s.fromLatLngToPoint(t.getSouthWest()),c=new google.maps.Point(a.x+n.x,a.y-n.y),l=new google.maps.Point(u.x-n.x,u.y+n.y),h=s.fromPointToLatLng(c),p=s.fromPointToLatLng(l);o.extend(h),o.extend(p)}var g=this.geohashGetLatLngBounds(e);return o.contains(g.getNorthEast())||o.contains(g.getSouthWest())||180===g.toSpan().lat()?!0:!1},s.prototype.addMarkers=function(e,t,r){if("[object Array]"===Object.prototype.toString.call(e))for(var o=0,s=e.length;s>o;o++){var i=e[o];this.addMarker(i,{type:t,subtype:r})}},s.prototype.addMarker=function(e,t){"undefined"==typeof t&&(t=i.getMarkerMeta(e));var r=new a["default"](e),o={type:"generic",subtype:"generic",hidden:!0,visible:!1};t=i.applyDefaults(o,t);var s=t.type,n=t.subtype;if("undefined"==typeof this.markers[s]&&(this.markers[s]={},this.cluster_meta[s]={count:{total:0,visible:0,cluster:0}}),"undefined"==typeof this.cluster_fns[s]&&this.setClusterFn(s,this.createClusterMarker),"undefined"==typeof this.markers[s][n]&&(this.markers[s][n]=[]),this.markers[s][n].push(r),"cluster"!==n&&(this.cluster_meta[s].count.total+=1,this.addToCluster(r,s,this.getPrecision())),"undefined"==typeof t.summary){var u=t.type.charAt(0).toUpperCase()+t.type.slice(1);t.summary="undefined"==typeof r.getTitle()?u+" marker "+this.count(t.type,"total"):r.getTitle()}i.setMarkerMeta(r,t)},s.prototype.count=function(e,t){return this.cluster_meta[e].count[t]},s.prototype.addToCluster=function(e,t,r,o){var s=this.clusters,i=e.getLatLng(),n=i.latitude,a=i.longitude;"undefined"==typeof s[r]&&(s[r]={}),"undefined"==typeof s[r][t]&&(s[r][t]={});var u=s[r][t];if("undefined"==typeof o&&(o=this.getGeohash(n,a,r)),"undefined"!=typeof u[o]){u[o].markers.push(e);var c=u[o].markers.length,l=(c-1)/c*u[o].center[0]+n/c,h=(c-1)/c*u[o].center[1]+a/c;u[o].center=[l,h]}else u[o]={cluster:!1,markers:[e],center:[n,a]}},s.prototype.removeFromCluster=function(e,t){var r=this.geohashGetPrecision(t),o=i.getMarkerMeta(e).type,s=this.clusters[r][o][t];if(1===s.markers.length)delete this.clusters[r][o][t];else if(s.markers.length>1){for(var n,a=0,u=[],c=0,l=0;n=s.markers[a];a++)n!==e&&(u.push(n),c+=n.getLatLng().latitude,l+=n.getLatLng().longitude);c/=u.length,l/=u.length,s.center=[c,l],s.markers=u,s.cluster=!1,this.clusters[r][o][t]=s}},s.prototype.combineBoxes=function(e,t,r){var o=this.geohashGetPrecision(e);if(this.clusters[o][r][e].markers.length<this.clusters[o][r][t].markers.length){var s=e;e=t,t=s}for(var i,n=this.clusters[o][r][t].markers.length,a=n-1;a>=0;a--)i=this.clusters[o][r][t].markers[a],this.removeFromCluster(i,t),this.addToCluster(i,r,o,e)},s.prototype.combineClustersByDistance=function(e){var t=this.getPrecision(),r=this.clusters,o=this.opts.cluster_distance_factor||2048e3;for(var s in r[t][e]){for(var i,n=this.getNeighborBoxes(s,e),a=o*Math.pow(2,-t+2),u=r[t][e][s].center,c=0,l=0;i=n[c];c++){u=r[t][e][s].center;var h=r[t][e][i].center,p=google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(u[0],u[1]),new google.maps.LatLng(h[0],h[1]));a>p&&(l=c,a=p)}l&&(i=n[l],this.combineBoxes(s,i,e))}},s.prototype.cluster=function(e){var t,r,o,s,n=this.getPrecision();if("undefined"!=typeof e){if("undefined"!=typeof this.markers[e]){if("undefined"!=typeof this.markers[e].cluster)for(s=0,r;r=this.markers[e].cluster[s];s++)r.setVisible(!1);this.markers[e].cluster=[],this.cluster_meta[e].count.cluster=0,t=this.clusters,this.opts.cluster_by_distance&&this.combineClustersByDistance(e);for(var a in t[n][e]){this.opts.visualize&&this.boxToPolygon(a).setMap(this.map);var u=t[n][e][a];for(s=0,o=[];r=u.markers[s];s++){var c=i.getMarkerMeta(r);"undefined"!=typeof c.hidden&&c.hidden||o.push(r)}o.length>1?(u.cluster=this.cluster_fns[e](o,u.center[0],u.center[1],this),this.addMarker(u.cluster,{type:e,subtype:"cluster",hidden:!1}),this.cluster_meta[e].count.cluster+=1):u.cluster=!1}}}else{t=this.clusters[n];for(e in t)this.cluster(e)}},s.prototype.getMarkers=function(e,t,r){var o=[];if(this.markers==={})return[];if("undefined"==typeof e)for(e in this.markers)for(t in this.markers[e])o=o.concat(this.markers[e][t]);else if("undefined"==typeof t)for(t in this.markers[e])o=o.concat(this.markers[e][t]);else try{o=this.markers[e][t]||[]}catch(s){o=[]}if("undefined"==typeof r)return o;for(var n=0,a=[],u=o.length;u>n;n++){var c=o[n],l=i.getMarkerMeta(c);("all"===r||l.hidden!==r&&l.visible===r&&"function"!=typeof c&&"cluster"!==l.type)&&a.push(c)}return a},s.prototype._onMapMoveEnd=function(){var e=this;"undefined"!=typeof e.moveTimeout&&(clearTimeout(e.moveTimeout),delete e.moveTimeout);var t=e.zoomToPrecision(e.map.getZoom());e.getPrecision()!==t?e.setPrecision(t):e.moveTimeout=setTimeout(function(){delete e.moveTimeout,e.updateMarkers()},100)},s.prototype.show=function(e,t){this._showHide(e,t,!1)},s.prototype.hide=function(e,t){this._showHide(e,t,!0)},s.prototype._showHide=function(e,t,r){for(var o=this,s=this.getMarkers(e,t),n=0,a=s.length;a>n;n++){var u=s[n];i.getMarkerMeta(u).hidden=r}this.ready_?this._lagUpdate(e):google.maps.event.addListenerOnce(this,"ready_",function(){o._lagUpdate(e)})},s.prototype._lagUpdate=function(e){var t=this;"undefined"!=typeof this.processingTimeout&&(clearTimeout(t.processingTimeout),delete t.processingTimeout),this.processingTimeout=setTimeout(function(){delete t.processingTimeout,t.clear(e),t.cluster(e),t.updateMarkers()},100)},s.prototype.reset=function(e){if("undefined"!=typeof e){this.clear(e);for(var t in this.clusters)delete this.clusters[t][e],this.clusters[t][e]={};delete this.markers[e],this.markers[e]={}}else{var r=this.clusters[this.getPrecision()];for(e in r)this.reset(e)}},s.prototype.clear=function(e){for(var t=this.getMarkers(e),r=0,o=t.length;o>r;r++){var s=t[r];s.setMap(null),i.getMarkerMeta(s).visible=!1}if("undefined"!=typeof e&&this.cluster_meta&&this.cluster_meta[e])this.cluster_meta[e].count.visible=0;else for(var n in this.cluster_meta)this.cluster_meta[n].count.visible=0},s.prototype.zoomToPrecision=function(e){return this.opts.zoom_to_precision(e)},s.prototype.updateMarkers=function(){var e,t,r,o,s=this.getPrecision(),n=this.map.getBounds(),a=this.clusters[s];for(var u in a){var c=a[u];for(var l in c){var h=c[l],p=i.getMarkerMeta(h.cluster);if(this.boxInBounds(l,n,this.opts.padding))if(h.cluster){if(!p.hidden&&!p.visible){for(o=0,r=h.markers.length;r>o;o++)e=h.markers[o],i.getMarkerMeta(e).visible=!0;h.cluster.setMap(this.map),h.cluster.setVisible(!0),p.visible=!0,this.cluster_meta[u].count.visible+=1}}else e=h.markers[0],t=i.getMarkerMeta(e),t.hidden||t.visible||(e.setMap(this.map),e.setVisible(!0),t.visible=!0,this.cluster_meta[u].count.visible+=1);else if(h.cluster)h.cluster.setVisible(!1),p.visible&&(this.cluster_meta[u].count.visible-=1),p.visible=!1;else for(o=0,r=h.markers.length;r>o;o++)e=h.markers[o],t=i.getMarkerMeta(e),e.setVisible(!1),t.visible&&(this.cluster_meta[u].count.visible-=1),t.visible=!1}}},s.prototype.setClusterFn=function(e,t){this.cluster_fns[e]=t},s.prototype.createClusterIcon=function(e,t,r,o){var s;if(o=o||"000000",t>10)s={url:"http://chart.apis.google.com/chart?cht=d&chdp=mapsapi&chl=pin%27i\\%27["+e+"%27-2%27f\\hv%27a\\]h\\]o\\"+r+"%27fC\\"+o+"%27tC\\000000%27eC\\Lauto%27f\\&ext=.png",size:new google.maps.Size(21,34)};else{var i=6*((e+"").length-1)+24;s={size:new google.maps.Size(i,i),anchor:new google.maps.Point(i/2,i/2),shape:{coord:[i/2,i/2,i/2],type:"circle"},url:"http://chart.apis.google.com/chart?cht=it&chs="+i+"x"+i+"&chco="+r+",000000ff,ffffff01&chl="+e+"&chx="+o+",0&chf=bg,s,00000000&ext=.png"}}return this.createMarkerIconOpts(s)},s.prototype.createClusterMarker=function(e,t,r,o){function s(e){return function(t){google.maps.event.trigger(e,"click",t)}}var n=document.createElement("div");n.style.width="400px";for(var a,u=0;a=e[u];u++){var c=document.createElement("span");if(c.innerHTML="<b>"+i.getMarkerMeta(a).summary+"</b><br>",c.onclick=s(a),c.style.color="#334499",c.style.cursor="pointer",n.appendChild(c),u>=9)break}e.length>10&&n.appendChild(document.createTextNode(e.length-10+" more markers in this area. Zoom in for details."));var l=o.opts.icon_color[i.getMarkerMeta(e[0]).type]||o.opts.icon_color,h=o.createClusterIcon(e.length,o.getPrecision(),l);return a=o.createMarker({position:new google.maps.LatLng(t,r),title:e.length+" markers",content:n,summary:e.length+" markers",icon:h,shape:h.shape,zIndex:e.length})},s.prototype.createMarkerIconOpts=function(e){"undefined"==typeof e&&(e={});var t="ff0000";return"undefined"!=typeof this.opts&&"undefined"!=typeof this.opts.icon_color&&("string"==typeof this.opts.icon_color?t=this.opts.icon_color:"object"==typeof this.opts.icon_color&&"undefined"!=typeof e.type&&"string"==typeof this.opts.icon_color[e.type]&&(t=this.opts.icon_color[e.type])),i.createMarkerIconOpts(i.applyDefaults({icon_color:t},e))},s.prototype.createMarker=function(e){return i.createMarker(this.map,i.applyDefaults({icon:this.createMarkerIconOpts(e)},e))}},{"./LazyMarker":2,"./utils":3}],2:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function s(e){this.raw_marker=e,this._marker="function"==typeof e.setMap?e:null,google.maps.event.addListener(this,"click",function(e){this._marker&&google.maps.event.trigger(this._marker,"click",e)})}Object.defineProperty(r,"__esModule",{value:!0});var i=e("./utils"),n=o(i);s.prototype.setMap=function(e){if(this._marker)return void this._marker.setMap(e);if(e){var t={title:this.raw_marker.title,type:!1,subtype:"",content:""},r=n["default"](t,this.raw_marker);this._marker=ClusterManager.prototype.createMarker({title:r.title,type:r.type,content:r.content,position:new google.maps.LatLng(r.latitutde,r.longitude),subtype:r.subtype}),this._marker.setMap(e)}},s.prototype.getPosition=function(){if(this._marker&&this._marker.getPosition())return this._marker.getPosition();var e=this.getLatLng();return this.raw_marker.position=new google.maps.LatLng(e.latitutde,e.longitude),this.raw_marker.position},s.prototype.getLatLng=function(){return this._marker&&"undefined"==typeof this.raw_marker.latitude&&(this.raw_marker.position=this._marker.getPosition(),this.raw_marker.latitude=this.raw_marker.position.lat(),this.raw_marker.longitude=this.raw_marker.position.lng()),{latitude:this.raw_marker.latitude,longitude:this.raw_marker.longitude}},s.prototype.getTitle=function(){return this._marker&&this._marker.getTitle()||this.raw_marker.title},s.prototype.setVisible=function(e){this._marker&&this._marker.setVisible(e)},r["default"]=s,t.exports=r["default"]},{"./utils":3}],3:[function(e,t,r){"use strict";function o(e,t){if("object"!=typeof e)return{};if("object"!=typeof t)return e;for(var r in e)"undefined"==typeof t[r]&&(t[r]=e[r]);return t}function s(e,t){var r=o(t,e._cluster_meta);e._cluster_meta=o(r,t)}function i(e){try{return e._cluster_meta}catch(t){return e._cluster_meta={},e._cluster_meta}}function n(e){"undefined"==typeof e&&(e={}),"undefined"==typeof e.width&&(e.width=32),"undefined"==typeof e.height&&(e.height=32);var t=e.width,r=e.height,s="ff0000";"undefined"!=typeof e.icon_color&&("string"==typeof e.icon_color?s=e.icon_color:"object"==typeof e.icon_color&&"undefined"!=typeof e.type&&"string"==typeof e.icon_color[e.type]&&(s=e.icon_color[e.type])),"undefined"==typeof e.strokeColor&&(e.strokeColor="000000"),"undefined"==typeof e.cornerColor&&(e.cornerColor="ffffff");var i="http://chart.apis.google.com/chart?cht=mm",n=i+"&chs="+t+"x"+r+"&chco="+e.cornerColor.replace("#","")+","+s+","+e.strokeColor.replace("#","")+"&ext=.png";return o({url:n,size:new google.maps.Size(t,r),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(t/2,r)},e)}function a(e,t){var r={map:e,visible:!1,icon:n(t),content:"Marker"};t=o(r,t);var i=new google.maps.Marker(t);if("undefined"==typeof t.fn){var a=new google.maps.InfoWindow({content:t.content});google.maps.event.addListener(i,"click",function(){var t=new Date;a.setZIndex(t.getTime()),a.open(e,i)})}else google.maps.event.addListener(i,"click",t.fn);return s(i,t),i}Object.defineProperty(r,"__esModule",{value:!0}),r.applyDefaults=o,r.setMarkerMeta=s,r.getMarkerMeta=i,r.createMarkerIconOpts=n,r.createMarker=a},{}]},{},[1]);
//# sourceMappingURL=clustermanager.min.js.map